import sqlite3
from prettytable import PrettyTable

# Conexão com o banco de dados SQLite
conn = sqlite3.connect('tarefas.db')
c = conn.cursor()

# Criação da tabela de tarefas
c.execute('''
CREATE TABLE IF NOT EXISTS tarefas (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    descricao TEXT NOT NULL,
    concluida BOOLEAN NOT NULL CHECK (concluida IN (0, 1))
)
''')
conn.commit()

def adicionar_tarefa(descricao):
    c.execute('INSERT INTO tarefas (descricao, concluida) VALUES (?, ?)', (descricao, 0))
    conn.commit()
    print("Tarefa adicionada com sucesso!")

def listar_tarefas():
    c.execute('SELECT * FROM tarefas')
    tarefas = c.fetchall()
    
    # Usando PrettyTable para formatar a saída
    table = PrettyTable()
    table.field_names = ["ID", "Descrição", "Concluída"]
    
    for tarefa in tarefas:
        table.add_row([tarefa[0], tarefa[1], "Sim" if tarefa[2] else "Não"])
    
    print(table)

def atualizar_tarefa(id_tarefa, concluida):
    c.execute('UPDATE tarefas SET concluida = ? WHERE id = ?', (concluida, id_tarefa))
    conn.commit()
    print("Tarefa atualizada com sucesso!")

def remover_tarefa(id_tarefa):
    c.execute('DELETE FROM tarefas WHERE id = ?', (id_tarefa,))
    conn.commit()
    print("Tarefa removida com sucesso!")

def main():
    while True:
        print("\nSistema de Gerenciamento de Tarefas")
        print("1. Adicionar Tarefa")
        print("2. Listar Tarefas")
        print("3. Atualizar Tarefa")
        print("4. Remover Tarefa")
        print("5. Sair")

        opcao = input("Escolha uma opção: ")

        if opcao == "1":
            descricao = input("Digite a descrição da tarefa: ")
            adicionar_tarefa(descricao)
        elif opcao == "2":
            listar_tarefas()
        elif opcao == "3":
            id_tarefa = int(input("Digite o ID da tarefa a ser atualizada: "))
            concluida = input("A tarefa foi concluída? (s/n): ").lower() == 's'
            atualizar_tarefa(id_tarefa, 1 if concluida else 0)
        elif opcao == "4":
            id_tarefa = int(input("Digite o ID da tarefa a ser removida: "))
            remover_tarefa(id_tarefa)
        elif opcao == "5":
            break
        else:
            print("Opção inválida! Tente novamente.")

if __name__ == "__main__":
    main()

